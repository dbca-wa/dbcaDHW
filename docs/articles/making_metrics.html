<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Making metrics • dbcaDHW</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Making metrics">
<meta property="og:description" content="dbcaDHW">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dbcaDHW</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dbca-wa/dbcaDHW/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="making_metrics_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Making metrics</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dbca-wa/dbcaDHW/blob/master/vignettes/making_metrics.Rmd"><code>vignettes/making_metrics.Rmd</code></a></small>
      <div class="hidden name"><code>making_metrics.Rmd</code></div>

    </div>

    
    
<p><img src="plots/dbcaDHWlogo2011.png"></p>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The aim of this vignette is to show a method of creating some useful SST metrics from daily data.</p>
<p>By following the vignette <strong>Using dbcaDHW</strong> there will be a csv of SST values and a folder structure that this analysis will utilise. Please read that vignette first if you haven’t done so.</p>
</div>
<div id="raster-creation" class="section level1">
<h1 class="hasAnchor">
<a href="#raster-creation" class="anchor"></a>Raster creation</h1>
<p>The metrics created are best stored in rasters to maintain their spatial relationship and can always be re-extracted depending on the need. In raster format they are also in a handy format for visualisation.</p>
<p>First up load up other required packages, read in the previously created data and set up a few useful objects.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyverse</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">lubridate</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">raster</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">rgdal</span>)

<span class="co">## read in extracted daily values</span>
<span class="no">dataset</span> <span class="kw">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"CRW3_1_extract_yourstartdate_yourfinishdate_SST_data.csv"</span>)

<span class="co">## sites</span>
<span class="no">sites</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html">names</a></span>(<span class="no">dataset</span>)[-<span class="fl">1</span>]
<span class="no">g_num</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">sites</span>) + <span class="fl">1</span></pre></body></html></div>
<p>Next up transform into a long format, create some new variables and remove leap days. This analysis will be based on 365 days in a year so we don’t need the complexity of including the 29th of February when it rolls around. Also set up a data frame to house all the results prior to writing rasters.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co">## wide to long and remove leap days</span>
<span class="no">ndata</span> <span class="kw">&lt;-</span> <span class="no">dataset</span> <span class="kw">%&gt;%</span>
  <span class="kw pkg">tidyr</span><span class="kw ns">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span>(<span class="st">"site"</span>, <span class="st">"temp"</span>, <span class="fl">2</span>:<span class="fu">all_of</span>(<span class="no">g_num</span>)) <span class="kw">%&gt;%</span>
  <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">year</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">dates</span>, <span class="fl">1</span>, <span class="fl">4</span>),
                <span class="kw">month</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">dates</span>, <span class="fl">6</span>, <span class="fl">7</span>),
                <span class="kw">day</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">dates</span>, <span class="fl">9</span>, <span class="fl">10</span>)) <span class="kw">%&gt;%</span>
  <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">month</span> <span class="kw">!=</span> <span class="st">"02"</span> <span class="kw">|</span> <span class="no">day</span> <span class="kw">!=</span> <span class="st">"29"</span>)

<span class="co">## set up output data frame</span>
<span class="no">outdf</span> <span class="kw">&lt;-</span> <span class="kw pkg">tibble</span><span class="kw ns">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span>(<span class="kw">Id</span> <span class="kw">=</span> <span class="no">sites</span>,
                    <span class="kw">hot_mean</span> <span class="kw">=</span> <span class="fl">0</span>,
                    <span class="kw">num_over</span> <span class="kw">=</span> <span class="fl">0</span>,
                    <span class="kw">mtemp_over</span> <span class="kw">=</span> <span class="fl">0</span>,
                    <span class="kw">strks_over</span> <span class="kw">=</span> <span class="fl">0</span>,
                    <span class="kw">lstrk_over</span> <span class="kw">=</span> <span class="fl">0</span>,
                    <span class="kw">max</span> <span class="kw">=</span> <span class="fl">0</span>,
                    <span class="kw">stringsAsFactors</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<p>Right, with the setup complete, loop over each site (which is a pixel through time) and define a <strong>past</strong> and <strong>present</strong> period. The user will have to input appropriate dates in the filter arguments below. The dates below are those used in the paper.</p>
<p>There is a neat gotcha below. Pay attention to the creation of the <strong>nday</strong> variable. We need to number all the days of each year consecutively in order to create a grouping variable so that we can compare all 1st of Januarys to each other etc. So if your data set starts on the 1st of January then its OK to start numbering from 1. However as can be seen in the creation of the <strong>present</strong> data set in which the period starts on the 1st of August, the numbering needed to start at 213. This all depends on what data the user has to analyse and what they define as a <strong>present</strong> starting date. Please choose appropriately.</p>
<p>In the <strong>past</strong> data set, also create an average temperature (e.g. average temperature for all 1st of Januarys etc). A number of metrics are then created and stored in the output data frame:</p>
<ul>
<li>hottest mean - <strong>past</strong> period.</li>
<li>number over - total number of days in <strong>present</strong> period over the hottest mean temperature.</li>
<li>max temperature over - degrees difference between maximum temperature in <strong>present</strong> period and hottest mean.</li>
<li>streaks over - number of times the <strong>present</strong> period temperature exceeded the hottest mean for at least 5 consecutive days. If 5 days is not appropriate , change in the code below.</li>
<li>longest streak - length in days of the longest streak of temperatures in <strong>present</strong> period over the hottest mean for at least 5 consecutive days. If 5 days is not appropriate , change in the code below.</li>
<li>max temperature - the hottest temperature in the <strong>present</strong> period.</li>
</ul>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">sites</span>)){
  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"Processing "</span>, <span class="no">sites</span>[<span class="no">i</span>], <span class="st">"...\n"</span>))
  <span class="co">## define past period - UPDATE WHEN NEW DATA</span>
  <span class="no">past</span> <span class="kw">&lt;-</span> <span class="no">ndata</span> <span class="kw">%&gt;%</span>
    <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">dates</span> <span class="kw">&lt;</span> <span class="st">"2010-08-01"</span>) <span class="kw">%&gt;%</span>
    <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">site</span> <span class="kw">==</span> <span class="no">sites</span>[<span class="no">i</span>]) <span class="kw">%&gt;%</span>
    <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">nday</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>:<span class="fl">365</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">day</span>))) <span class="kw">%&gt;%</span> <span class="co">#gotta match first start date</span>
    <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">nday</span>) <span class="kw">%&gt;%</span>
    <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">avg</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">temp</span>)) <span class="kw">%&gt;%</span>
    <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span>()

  <span class="co">## define present period</span>
  <span class="no">present</span> <span class="kw">&lt;-</span> <span class="no">ndata</span> <span class="kw">%&gt;%</span>
    <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">dates</span> <span class="kw">&gt;=</span> <span class="st">"2010-08-01"</span> <span class="kw">&amp;</span> <span class="no">dates</span> <span class="kw">&lt;=</span> <span class="st">"2011-07-31"</span>) <span class="kw">%&gt;%</span>
    <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">site</span> <span class="kw">==</span> <span class="no">sites</span>[<span class="no">i</span>]) <span class="kw">%&gt;%</span>
    <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">nday</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">213</span>:<span class="fl">365</span>, <span class="fl">1</span>:<span class="fl">212</span>)) <span class="co">#gotta match first start date</span>

  <span class="co">## hottest mean</span>
  <span class="no">hot_mean</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">past</span>$<span class="no">avg</span>)

  <span class="co"># present temps indicating which higher than threshold</span>
  <span class="no">presenthighs</span> <span class="kw">&lt;-</span> <span class="no">present</span> <span class="kw">%&gt;%</span>
    <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">overthresh</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">temp</span> <span class="kw">&gt;</span> <span class="no">hot_mean</span>, <span class="st">"Y"</span>, <span class="st">"N"</span>))

  <span class="co">## rle</span>
  <span class="no">streak</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rle.html">rle</a></span>(<span class="no">presenthighs</span>$<span class="no">overthresh</span>)

  <span class="co">## number and lengths of streaks - CHANGE IF 5 DAYS NOT APPROPRIATE</span>
  <span class="no">streakdf</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">sval</span> <span class="kw">=</span> <span class="no">streak</span><span class="kw">[[</span><span class="fl">2</span>]],
                         <span class="kw">slgth</span> <span class="kw">=</span> <span class="no">streak</span><span class="kw">[[</span><span class="fl">1</span>]],
                         <span class="kw">stringsAsFactors</span> <span class="kw">=</span> <span class="fl">FALSE</span>) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">sval</span> <span class="kw">==</span> <span class="st">"Y"</span> <span class="kw">&amp;</span> <span class="no">slgth</span> <span class="kw">&gt;=</span> <span class="fl">5</span>)

  <span class="co">## number over hottest mean</span>
  <span class="no">num_over</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">streakdf</span>$<span class="no">slgth</span>)

  <span class="co">## max temp over hottest mean</span>
  <span class="no">mtemp_over</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">present</span>$<span class="no">temp</span>) - <span class="no">hot_mean</span>

  <span class="co">## num streaks above hottest mean</span>
  <span class="no">strks_over</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">streakdf</span>$<span class="no">slgth</span>)

  <span class="co">## longest streak over hottest mean</span>
  <span class="no">lstrk_over</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">streakdf</span>$<span class="no">slgth</span>)

  <span class="co">## fill output data frame</span>
  <span class="no">outdf</span>[<span class="no">i</span>, <span class="fl">2</span>] <span class="kw">&lt;-</span> <span class="no">hot_mean</span>
  <span class="no">outdf</span>[<span class="no">i</span>, <span class="fl">3</span>] <span class="kw">&lt;-</span> <span class="no">num_over</span>
  <span class="no">outdf</span>[<span class="no">i</span>, <span class="fl">4</span>] <span class="kw">&lt;-</span> <span class="no">mtemp_over</span>
  <span class="no">outdf</span>[<span class="no">i</span>, <span class="fl">5</span>] <span class="kw">&lt;-</span> <span class="no">strks_over</span>
  <span class="no">outdf</span>[<span class="no">i</span>, <span class="fl">6</span>] <span class="kw">&lt;-</span> <span class="no">lstrk_over</span>
  <span class="no">outdf</span>[<span class="no">i</span>, <span class="fl">7</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">present</span>$<span class="no">temp</span>)
}</pre></body></html></div>
<p>Now its time to write all of these results to rasters. Use one of the existing img files to use as a template (sets up cell resolution, crs etc) and also write all of these results to the extraction shape file.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co">## grab example of orig SST img raster to use as template</span>
<span class="no">temp_raster</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html">raster</a></span>(<span class="st">"./img_data/1985/b5km_sst_v3.1_19850101.img"</span>)

<span class="co">## grab extraction shape file to add to</span>
<span class="no">e_pts</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rgdal/man/readOGR.html">readOGR</a></span>(<span class="kw">dsn</span> <span class="kw">=</span> <span class="st">"."</span>, <span class="kw">layer</span> <span class="kw">=</span> <span class="st">"extraction_pts_3577"</span>)

<span class="co">## add new metrics to extraction shape file</span>
<span class="no">e_pts</span>@<span class="kw">data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">e_pts</span>@<span class="kw">data</span>, <span class="no">outdf</span>[<span class="fu"><a href="https://rdrr.io/pkg/raster/man/match.html">match</a></span>(<span class="no">e_pts</span>@<span class="kw">data</span>$<span class="no">Id</span>, <span class="no">outdf</span>$<span class="no">Id</span>),])

<span class="co">## create a folder for output rasters</span>
<span class="kw">if</span>(!<span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.exists</a></span>(<span class="st">"./sst_metrics"</span>)){<span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span>(<span class="st">"./sst_metrics"</span>)}

<span class="co">## write out rasters</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/rasterize.html">rasterize</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">e_pts</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">temp_raster</span>, <span class="kw">field</span> <span class="kw">=</span> <span class="st">"num_over"</span>,
          <span class="kw">filename</span> <span class="kw">=</span> <span class="st">"./SST_metrics/num_threshold_temp_over_3577.img"</span>)

<span class="fu"><a href="https://rdrr.io/pkg/raster/man/rasterize.html">rasterize</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">e_pts</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">temp_raster</span>, <span class="kw">field</span> <span class="kw">=</span> <span class="st">"mtemp_over"</span>,
          <span class="kw">filename</span> <span class="kw">=</span> <span class="st">"./SST_metrics/max_temp_over_3577.img"</span>)

<span class="fu"><a href="https://rdrr.io/pkg/raster/man/rasterize.html">rasterize</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">e_pts</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">temp_raster</span>, <span class="kw">field</span> <span class="kw">=</span> <span class="st">"strks_over"</span>,
          <span class="kw">filename</span> <span class="kw">=</span> <span class="st">"./SST_metrics/number_strks_over_3577.img"</span>)

<span class="fu"><a href="https://rdrr.io/pkg/raster/man/rasterize.html">rasterize</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">e_pts</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">temp_raster</span>, <span class="kw">field</span> <span class="kw">=</span> <span class="st">"lstrk_over"</span>,
          <span class="kw">filename</span> <span class="kw">=</span> <span class="st">"./SST_metrics/longest_strk_over_3577.img"</span>)

<span class="fu"><a href="https://rdrr.io/pkg/raster/man/rasterize.html">rasterize</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">e_pts</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">temp_raster</span>, <span class="kw">field</span> <span class="kw">=</span> <span class="st">"hot_mean"</span>,
          <span class="kw">filename</span> <span class="kw">=</span> <span class="st">"./SST_metrics/hot_mean_temp_3577.img"</span>)

<span class="fu"><a href="https://rdrr.io/pkg/raster/man/rasterize.html">rasterize</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">e_pts</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">temp_raster</span>, <span class="kw">field</span> <span class="kw">=</span> <span class="st">"max"</span>,
          <span class="kw">filename</span> <span class="kw">=</span> <span class="st">"./SST_metrics/max_temp_3577.img"</span>)</pre></body></html></div>
<p>With the data stored as rasters they can easily be turned into visualisations by adding in some additional vectors representing regions and coastlines etc.</p>
<p><img src="plots/max-over.png"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Bart Huntley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
