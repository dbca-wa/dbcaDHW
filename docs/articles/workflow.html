<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using dbcaDHW • dbcaDHW</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using dbcaDHW">
<meta property="og:description" content="dbcaDHW">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dbcaDHW</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dbca-wa/dbcaDHW/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using dbcaDHW</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dbca-wa/dbcaDHW/blob/master/vignettes/workflow.Rmd"><code>vignettes/workflow.Rmd</code></a></small>
      <div class="hidden name"><code>workflow.Rmd</code></div>

    </div>

    
    
<p><img src="plots/dbcaDHWlogo2011.png"></p>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The intention behind this package is to share how we went about creating some useful SST data that was used in the Global Change Biology journal paper, <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/gcb.15065">“Too hot to handle: Unprecedented seagrass death driven by marine heatwave in a World Heritage Area”</a>. The functions and workflow suited the particular data and modelling needs presented in the paper and as such probably won’t be directly transferable to other data sets. However it should provide some ideas and all code can be examined in the <a href="https://github.com/dbca-wa/dbcaDHW">package GitHub repo</a>.</p>
<p>Functions used in this package will:</p>
<ol style="list-style-type: decimal">
<li><p>convert global SST data sets into more manageable img formatted cropped versions (defaults to the Western Australian region).</p></li>
<li><p>based on a user provided area of interest, create vector shape files based on the geometry of the SST data.</p></li>
<li><p>extract daily SST values and export them to csv file for further analysis.</p></li>
</ol>
<p>Lastly, the vignettes <strong>Making metrics</strong> and <strong>Degree heating weeks</strong> will show how to use the exported data to create useful SST metrics.</p>
</div>
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1>
<p>You can install the development version from <a href="https://github.com/dbca-wa">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="co"># install.packages("devtools")</span>
<span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"dbca-wa/dbcaDHW"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dbcaDHW</span>)</pre></body></html></div>
</div>
<div id="data" class="section level1">
<h1 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h1>
<p>The functions were designed to be used on <a href="ftp://ftp.star.nesdis.noaa.gov/pub/sod/mecb/crw/data/5km/v3.1/nc/v0.1/daily/sst/">NOAA’s Coral Reef Watch SST data</a>. The data is daily sea surface temperatures (SST) in netcdf format (nc).</p>
</div>
<div id="folder-structure" class="section level1">
<h1 class="hasAnchor">
<a href="#folder-structure" class="anchor"></a>Folder Structure</h1>
<p>A working directory or R Studio project needs to be determined. The downloaded data and any user supplied shape files should be stored here. Below, a processing file called <code>sst_processing/</code> is being used to demonstrate.</p>
<p>The downloaded data should be stored in a directory called <code>nc_data/</code> and within that the data is further organised by year directories. This example shows only the first 4 days of 1985 and 1986. Also present in the working directory is a region of interest (optional) and an area of interest shape file (required) and these will be discussed further.</p>
<p>Any outputs created by the functions will end up in the working directory.</p>
<p><img src="plots/start.PNG"></p>
</div>
<div id="workflow" class="section level1">
<h1 class="hasAnchor">
<a href="#workflow" class="anchor"></a>Workflow</h1>
<div id="step-1" class="section level3">
<h3 class="hasAnchor">
<a href="#step-1" class="anchor"></a>Step 1</h3>
<p>Firstly the downloaded data needs to be saved to img format. This format works well with GIS software and is also easier to handle if cropped to a smaller area. The <code>nc_to_img</code> function below defaults to cropping the outputs to a Western Australian region but the user can supply their own if desired. The below example uses the working directory and region of interest as described above.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co"># user supplied region of interest</span>
<span class="fu"><a href="../reference/nc_to_img.html">nc_to_img</a></span>(<span class="kw">pathin</span> <span class="kw">=</span> <span class="st">"X:/DATA/SST/CRW/sst_processing"</span>, <span class="kw">vector</span> <span class="kw">=</span> <span class="st">"region_of_interest_WGS84"</span>)

<span class="co"># default WA region</span>
<span class="fu"><a href="../reference/nc_to_img.html">nc_to_img</a></span>(<span class="kw">pathin</span> <span class="kw">=</span> <span class="st">"X:/DATA/SST/CRW/sst_processing"</span>)</pre></body></html></div>
<p>User supplied shape files can have any coordinate reference system as the function will transform to EPSG 3577 (Australian Albers) prior to cropping. When supplying the layer name do not include the suffix. Output img files will be saved in the working directory to a folder called <code>img_data/</code> and will be organised by year. They will also have an EPSG of 3577.</p>
</div>
<div id="step-2" class="section level3">
<h3 class="hasAnchor">
<a href="#step-2" class="anchor"></a>Step 2</h3>
<p>The function <code>create_vectors</code> will then create 2 new vector files. The user will need to supply an area of interest to further narrow the focus. The output vector files will be created from the geometry of the img raster data. An extraction vector will be created from the centroids of the SST pixels that fall within the area of interest. A cell boundaries vector (based on the pixel boundaries) will also be generated. Whilst not used in any processing here it can be useful to for visualisation.</p>
<p>Both output vector files have an EPSG of 3577 and are also attributed with a common 4 digit site number. Again, the coordinate reference system of the input vector, the area of interest shape file, doesn’t matter.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># user supplied area of interest</span>
<span class="fu"><a href="../reference/create_vectors.html">create_vectors</a></span>(<span class="kw">pathin</span> <span class="kw">=</span> <span class="st">"X:/DATA/SST/CRW/sst_processing"</span>, <span class="kw">aoi</span> <span class="kw">=</span> <span class="st">"area_of_interest_WGS84"</span>)</pre></body></html></div>
</div>
<div id="step-3" class="section level3">
<h3 class="hasAnchor">
<a href="#step-3" class="anchor"></a>Step 3</h3>
<p>The last stage is to use the function <code>extract_daily</code> to extract the SST values using the extraction vector that was just made.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co"># extract daily SST</span>
<span class="fu"><a href="../reference/extract_daily.html">extract_daily</a></span>(<span class="kw">pathin</span> <span class="kw">=</span> <span class="st">"X:/DATA/SST/CRW/sst_processing"</span>)</pre></body></html></div>
<p>All SST values are then compiled and output to csv file.</p>
<p><img src="plots/sst.PNG"></p>
<p>The working directory should now look the below. Note there is now a directory tree with img data as well as two new vectors and the csv of SST results.</p>
<p><img src="plots/fin.PNG"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Bart Huntley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
