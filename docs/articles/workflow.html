<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using dbcaDHW • dbcaDHW</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using dbcaDHW">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dbcaDHW</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dbca-wa/dbcaDHW/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using dbcaDHW</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dbca-wa/dbcaDHW/blob/HEAD/vignettes/workflow.Rmd" class="external-link"><code>vignettes/workflow.Rmd</code></a></small>
      <div class="hidden name"><code>workflow.Rmd</code></div>

    </div>

    
    
<p><img src="plots%2FdbcaDHWlogo2011.png"></p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The intention behind this package is to share how we went about
creating some useful SST data that was used in the Global Change Biology
journal <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/gcb.15065" class="external-link">paper</a>,
<em>“Too hot to handle: Unprecedented seagrass death driven by marine
heatwave in a World Heritage Area”</em>.</p>
<p>The functions and workflow suited the particular data and modelling
needs presented in the paper and as such probably won’t be directly
transferable to other data sets. However it should provide some ideas
and all code can be examined in the <a href="https://github.com/dbca-wa/dbcaDHW/" class="external-link">package GitHub repo</a>.</p>
<p>Functions used in this package will:</p>
<ol style="list-style-type: decimal">
<li><p>convert global SST data sets into more manageable img formatted
cropped versions (defaults to the Western Australian region).</p></li>
<li><p>based on a user provided area of interest, create vector shape
files based on the geometry of the SST data.</p></li>
<li><p>extract daily SST values and export them to csv file for further
analysis.</p></li>
</ol>
<p>Lastly, the articles <strong>Making metrics</strong> and
<strong>Degree heating weeks</strong> will show how to use the exported
data to create useful SST metrics.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version from <a href="https://github.com/dbca-wa" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"dbca-wa/dbcaDHW"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dbca-wa/dbcaDHW" class="external-link">dbcaDHW</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>The functions were designed to be used on <a href="https://coralreefwatch.noaa.gov/product/5km/" class="external-link">NOAA’s Coral Reef
Watch SST data</a>. The data is daily sea surface temperatures (SST) in
netcdf format (nc).</p>
</div>
<div class="section level2">
<h2 id="folder-structure">Folder Structure<a class="anchor" aria-label="anchor" href="#folder-structure"></a>
</h2>
<p>A working directory or R Studio project needs to be determined. The
downloaded data and any user supplied shape files should be stored here.
Below, a processing folder called <code>sst_processing/</code> is being
used to demonstrate.</p>
<p>The downloaded data should be stored in a directory called
<code>nc_data/</code> and within that the data is further organised by
year directories. This example shows only the first 4 days of 1985 and
1986. Also present in the working directory is a region of interest
(optional) and an area of interest shape file (required) and these will
be discussed further.</p>
<p>Any outputs created by the functions will end up in the working
directory.</p>
<p><img src="plots%2Fstart.PNG"></p>
</div>
<div class="section level2">
<h2 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h2>
<div class="section level4">
<h4 id="step-1">Step 1<a class="anchor" aria-label="anchor" href="#step-1"></a>
</h4>
<p>Firstly the downloaded data needs to be saved to img format. This
format works well with GIS software and is also easier to handle if
cropped to a smaller area. The <code>nc_to_img</code> function below
defaults to cropping the outputs to a Western Australian region but the
user can supply their own if desired. The below example uses the working
directory and region of interest as described above.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># user supplied region of interest</span></span>
<span><span class="fu"><a href="../reference/nc_to_img.html">nc_to_img</a></span><span class="op">(</span>pathin <span class="op">=</span> <span class="st">"X:/DATA/SST/CRW/sst_processing"</span>, vector <span class="op">=</span> <span class="st">"region_of_interest_WGS84"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># default WA region omit the vector parameter</span></span>
<span><span class="fu"><a href="../reference/nc_to_img.html">nc_to_img</a></span><span class="op">(</span>pathin <span class="op">=</span> <span class="st">"X:/DATA/SST/CRW/sst_processing"</span><span class="op">)</span></span></code></pre></div>
<p>User supplied shape files can have any coordinate reference system as
the function will transform to EPSG 3577 (Australian Albers) prior to
cropping. When supplying the layer name do not include the suffix.
Output img files will be saved in the working directory to a folder
called <code>img_data/</code> and will be organised by year. They will
also have an EPSG of 3577.</p>
</div>
<div class="section level4">
<h4 id="step-2">Step 2<a class="anchor" aria-label="anchor" href="#step-2"></a>
</h4>
<p>The function <code>create_vectors</code> will then create 2 new
vector files. The user will need to supply an area of interest to
further narrow the focus. The output vector files will be created from
the geometry of the img raster data. An extraction vector will be
created from the centroids of the SST pixels that fall within the area
of interest. A cell boundaries vector (based on the pixel boundaries)
will also be generated. Whilst not used in any processing here it can be
useful for visualisation.</p>
<p>Both output vector files have an EPSG of 3577 and are also attributed
with a common 4 digit site number. Again, the coordinate reference
system of the input vector, the area of interest shape file, doesn’t
matter.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># user supplied area of interest</span></span>
<span><span class="fu"><a href="../reference/create_vectors.html">create_vectors</a></span><span class="op">(</span>pathin <span class="op">=</span> <span class="st">"X:/DATA/SST/CRW/sst_processing"</span>, aoi <span class="op">=</span> <span class="st">"area_of_interest_WGS84"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="step-3">Step 3<a class="anchor" aria-label="anchor" href="#step-3"></a>
</h4>
<p>The last stage is to use the function <code>extract_daily</code> to
extract the SST values using the extraction vector that was just
made.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># extract daily SST</span></span>
<span><span class="fu"><a href="../reference/extract_daily.html">extract_daily</a></span><span class="op">(</span>pathin <span class="op">=</span> <span class="st">"X:/DATA/SST/CRW/sst_processing"</span><span class="op">)</span></span></code></pre></div>
<p>All SST values are then compiled and output to csv file.</p>
<p><img src="plots%2Fsst.PNG"></p>
<p>The working directory should now look like the below. Note there is
now a directory tree with img data as well as two new vectors and the
csv of SST results.</p>
<p><img src="plots%2Ffin.PNG"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Bart Huntley.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
